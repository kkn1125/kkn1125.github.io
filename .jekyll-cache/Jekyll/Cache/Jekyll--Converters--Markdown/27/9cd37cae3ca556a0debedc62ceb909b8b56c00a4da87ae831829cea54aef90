I"èu<h1 id="spa-êµ¬í˜„">SPA êµ¬í˜„</h1>

<p>ì œëª©ì„ ì–´ë–»ê²Œ ì§€ì„ê¹Œ í•˜ë‹¤ê°€ ì„ì‹œë¡œ ì•„ëŠ” ë‹¨ì–´ë¥¼ ì ì–´ë‘ì—ˆìŠµë‹ˆë‹¤â€¦</p>

<p><code class="language-plaintext highlighter-rouge">SPA</code>ëŠ” <code class="language-plaintext highlighter-rouge">Single Page Application</code>ì˜ ì•½ìì´ê³  í•˜ë‚˜ì˜ í˜ì´ì§€ì— ë™ì ìœ¼ë¡œ í™”ë©´ì„ ë°”ê¿”ê°€ë©´ì„œ ìƒí˜¸ì‘ìš©í•˜ë„ë¡ í•©ë‹ˆë‹¤.</p>

<p>ì•„ì§ ë¼ìš°í„°ì— ëŒ€í•´ ì œëŒ€ë¡œëœ ì§€ì‹ì´ ì—†ì–´ ì§€ì ì„ ì£¼ì‹œë©´ ê³§ë°”ë¡œ ìˆ˜ì •í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ê¸°ë¡í•  ì£¼ìš” ë‚´ìš©ì€ ì´ë ‡ìŠµë‹ˆë‹¤.</p>

<p>ë¨¼ì € <code class="language-plaintext highlighter-rouge">ajax</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì œì™¸í–ˆìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">ajax</code>ë¡œ í•˜ê¸°ì— ì•„ì§ <code class="language-plaintext highlighter-rouge">fetch</code>ì™€ <code class="language-plaintext highlighter-rouge">async</code>, <code class="language-plaintext highlighter-rouge">await</code>ë¥¼ ì˜ ë‹¤ë£¨ì§€ ëª»í•˜ëŠ” ì‹œì ì´ë¼ <code class="language-plaintext highlighter-rouge">javascript</code>ë¡œ <code class="language-plaintext highlighter-rouge">render</code>ì™€ <code class="language-plaintext highlighter-rouge">component</code>ë¥¼ êµ¬í˜„í•´ì„œ ë°ì´í„°ë¥¼ ë§Œë“¤ì–´ ì ìš©í•˜ëŠ” ì—°ìŠµì„ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">SPA</code>ì—ëŠ” ì°¾ì•„ë³´ë‹ˆ ì¢…ë¥˜ê°€ ëª‡ ê°€ì§€ ìˆì—ˆëŠ”ë°ìš”.</p>

<ol>
  <li>Slash</li>
  <li>Hash</li>
  <li>Query</li>
</ol>

<p>ì´ ì™¸ì—ë„ ë” ìˆê² ì£ ? ì•„ë‹Œê°€? ì œê°€ í•´ ë³¸ ë‚´ìš©ì€ 3ê°€ì§€ ë‹¤ êµ¬í˜„ì„ í•´ë´¤ìŠµë‹ˆë‹¤.</p>

<p>ì´ì¤‘ì—ì„œ ë§ˆìŒì— ë“œëŠ” ê²°ê³¼ë¬¼ì„ ì£¼ëŠ” ê²Œ <code class="language-plaintext highlighter-rouge">hash</code>ë°©ì‹ì´ì—ˆìŠµë‹ˆë‹¤.</p>

<h2 id="slash-ë°©ì‹">Slash ë°©ì‹</h2>

<p><code class="language-plaintext highlighter-rouge">Slash</code>ë°©ì‹ì€ í˜¸ê¸°ë¡­ê²Œ êµ¬í˜„í•˜ë‹¤ê°€ ê²°êµ­ ë¦¬ë¡œë“œ(ìƒˆë¡œê³ ì¹¨)ì˜ ëŠªì„ ê³ ë¯¼í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ë¬¼ë¡  <code class="language-plaintext highlighter-rouge">Slash</code>ë°©ì‹ì—ì„œ ìƒˆë¡œê³ ì¹¨ì‹œ ë³´ê³ ìˆë˜ í˜ì´ì§€ì˜ ë‚´ìš©ì„ ë‹¤ì‹œ ë¡œë“œí•  ë°©ë²•ì€ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë„¤ì´ë²„ë‚˜ êµ¬ê¸€ì˜ ì„œì¹˜ì½˜ì†”ì—ì„œ ì ‘ê·¼ì´ ì•ˆë˜ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤.</p>

<p>í´ë”ë¥¼ ë§Œë“¤ì–´ë³´ê±°ë‚˜ ë¹ˆíŒŒì¼ì„ ë§Œë“œëŠ” ë“±ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ê±°ì³¤ì§€ë§Œ ì•„ì§ ë¯¸ì²œí•œ ì‹¤ë ¥ìœ¼ë¡œ í•´ê²°ì´ ì•ˆë˜ëŠ” ë¶€ë¶„ì´ê¸°ë„ í•˜êµ¬ìš”â€¦</p>

<p>í˜¹ì‹œë‚˜ <code class="language-plaintext highlighter-rouge">Slash</code>ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ê³  ìˆëŠ” ë¶„ ì¤‘ì— ê¶ê¸ˆí•´í•˜ì‹œëŠ” ë¶„ì„ ìœ„í•´ ì•„ë˜ ì˜ˆì œ ì½”ë“œë¥¼ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="c1">// router.js</span>

<span class="kd">let</span> <span class="nx">isFirst</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">beforeunload</span><span class="dl">'</span><span class="p">,</span> <span class="nx">handleInitializePage</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">handleInitializePage</span><span class="p">(</span><span class="nx">ev</span><span class="p">){</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="nx">ev</span><span class="p">.</span><span class="nx">returnValue</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isFirst</span><span class="p">){</span>
        <span class="nx">setTimeout</span><span class="p">(()</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">;</span>
            <span class="nx">getBeforePage</span><span class="p">();</span> <span class="c1">// ì ë‹¹íˆ êµ¬í˜„í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</span>
        <span class="p">},</span> <span class="mi">10</span><span class="p">);</span>
        <span class="nx">isFirst</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">beforeunload</code>ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•œ ì˜ˆì œì…ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">beforeunload</code>ë¡œ ë¦¬ë¡œë“œë˜ê±°ë‚˜ ì¢…ë£Œë  ë•Œë¥¼ ê°ì§€í•©ë‹ˆë‹¤. í¬ë¡¬ê¸°ì¤€ìœ¼ë¡œ ì´ë²¤íŠ¸ ì½œë°±í•¨ìˆ˜ ë‚´ì—ì„œ <code class="language-plaintext highlighter-rouge">alert()</code>ì„ ì‚¬ìš©í•˜ê²Œë˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬¼ë¡  <code class="language-plaintext highlighter-rouge">location.href</code>ë„ ê·¸ëƒ¥ ì“°ë©´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>

<p>ì°°ë‚˜ì— ëœ¨ëŠ” ì˜¤ë¥˜ë¥¼ ë³´ë©´ <code class="language-plaintext highlighter-rouge">beforeunload</code>ì´ë²¤íŠ¸ê°€ ì‘ë™ ë˜ëŠ” ë•Œì—ëŠ” í•¨ìˆ˜ì˜ ì‹¤í–‰ ë“±ì„ ë§‰ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  <code class="language-plaintext highlighter-rouge">getBeforePage</code>ë¼ëŠ” í•¨ìˆ˜ë¡œ ì´ì „ í˜ì´ì§€ ì •ë³´ë¥¼ ê°€ì ¸ì™€ <code class="language-plaintext highlighter-rouge">history API</code>ì˜ <code class="language-plaintext highlighter-rouge">pushState</code>ë¡œ ë³€ê²½í•´ì£¼ë©´ <code class="language-plaintext highlighter-rouge">/test</code>ë¼ëŠ” ì£¼ì†Œë¥¼ <code class="language-plaintext highlighter-rouge">/</code>ë¡œ ë°”ê¿¨ë‹¤ê°€ <code class="language-plaintext highlighter-rouge">/test</code>ë¡œ ë‹¤ì‹œ ìˆœì‹ê°„ì— ë°”ê¿”ì¤ë‹ˆë‹¤.</p>

<p>ë¦¬ë¡œë“œ ì‹œ ì£¼ì†Œë¥¼ ì´ˆê¸°í™”í–ˆë‹¤ê°€ ë°”ê¿”ì£¼ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ <code class="language-plaintext highlighter-rouge">Slash</code>ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•´ë„ ì˜ ì‘ë™ì€ í•˜ì§€ë§Œ ë¬¸ì œëŠ” ì•ì„œ ë§í•œ ê²ƒì²˜ëŸ¼ ë‹¤ë¥¸ ê³³ì—ì„œ í•´ë‹¹ <code class="language-plaintext highlighter-rouge">url</code>ì„ ìš”ì²­í•˜ë©´ í˜ì´ì§€ê°€ ì—†ë‹¤ê³  ëœ¹ë‹ˆë‹¤.</p>

<p>ì„œë²„ë¥¼ êµ¬í˜„í•œë‹¤ë©´ ìœ„ì˜ ì‘ì—…ì´ ì•„ì˜ˆ í•„ìš” ì—†ê² ì§€ë§Œìš”â€¦</p>

<h2 id="hash-ë°©ì‹">Hash ë°©ì‹</h2>

<p><code class="language-plaintext highlighter-rouge">hash</code>ë°©ì‹ì€ ë¹„êµì  ì‰¬ì› ìŠµë‹ˆë‹¤. ì–´ë–»ê²Œí•˜ë©´ <code class="language-plaintext highlighter-rouge">Slash</code>ë°©ì‹ ì²˜ëŸ¼ ë²ˆê±°ë¡­ì§€ ì•Šì„ê¹Œ í•˜ë‹¤ê°€ ìŠ¤í¬ë¡¤ ì¡°ì •í•  ë•Œ ìì£¼ ì‚¬ìš©í•œ <code class="language-plaintext highlighter-rouge">#</code>ì´ ë– ì˜¬ëìŠµë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">hash</code>ëŠ” íƒœê·¸ì˜ <code class="language-plaintext highlighter-rouge">id</code>ì„ íƒìì´ê¸° ë•Œë¬¸ì— ë¦¬ë¡œë“œí•˜ì§€ ì•Šê³  í•´ë‹¹ <code class="language-plaintext highlighter-rouge">id</code>ë¥¼ ê°€ì§„ íƒœê·¸ë¡œ ìŠ¤í¬ë¡¤ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ í•´ì‰¬ë¡œ ì‘ì—…í•˜ë©´ ì™¸ë¶€ ë§í¬ ì´ë™ì´ë‚˜ ìŠ¤í¬ë¡¤ì„ ì§ì ‘ êµ¬í˜„í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>

<h3 id="ìŠ¤í¬ë¡¤-ì™¸ë¶€ë§í¬-í˜ì´ì§•-ì²˜ë¦¬">ìŠ¤í¬ë¡¤, ì™¸ë¶€ë§í¬, í˜ì´ì§• ì²˜ë¦¬</h3>

<p>ì—¬ëŸ¬ ë°©ë²•ì´ ìˆê² ì§€ë§Œ ì œê°€ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="c1">// scroll</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="nx">handleAnchor</span><span class="p">);</span>
<span class="kd">function</span> <span class="nx">handleAnchor</span><span class="p">(</span><span class="nx">ev</span><span class="p">){</span>
    <span class="kd">const</span> <span class="nx">anchor</span> <span class="o">=</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">anchor</span><span class="p">.</span><span class="nx">tagName</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">anchor</span><span class="p">.</span><span class="nx">href</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">anchor</span><span class="p">.</span><span class="nx">hash</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">anchor</span><span class="p">.</span><span class="nx">attributes</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">name</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">A</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ev</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>

        <span class="c1">// ì—¬ê¸°ì„œ anchor.hrefë¡œ ì•ˆí•˜ëŠ” ì´ìœ ëŠ”</span>
        <span class="c1">// anchor.hrefë¡œ ëŒ€ì¡°í•˜ë©´ #testë¡œ ì§€ì •í–ˆì–´ë„</span>
        <span class="c1">// í”„ë¡œí† ì½œ í¬í•¨í•˜ì—¬ ë‚˜ì˜¤ê²Œ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">validHTTP</span><span class="p">(</span><span class="nx">attrs</span><span class="p">[</span><span class="dl">'</span><span class="s1">href</span><span class="dl">'</span><span class="p">].</span><span class="nx">value</span><span class="p">))</span> <span class="nb">window</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">href</span><span class="p">);</span> <span class="c1">// ì™¸ë¶€ ë§í¬ ìƒˆì°½ìœ¼ë¡œ ì—´ê¸°</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">hash</span><span class="o">!==</span><span class="dl">''</span><span class="p">){</span>
                <span class="nx">changeCurrentPage</span><span class="p">(</span><span class="nx">hash</span><span class="p">);</span> <span class="c1">// í˜ì´ì§•</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">scrollIntoRef</span><span class="p">(</span><span class="nx">attrs</span><span class="p">[</span><span class="dl">'</span><span class="s1">scroll-to</span><span class="dl">'</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span> <span class="c1">// ìŠ¤í¬ë¡¤ë§</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">validHTTP</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">url</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/http/gm</span><span class="p">)?</span><span class="kc">true</span><span class="p">:</span><span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">scrollIntoRef</span><span class="p">(</span><span class="nx">target</span><span class="p">){</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">target</span><span class="p">).</span><span class="nx">scrollIntoView</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ìœ„ ì˜ˆì œëŠ” í•œ ë²ˆì— ë³´ì—¬ë“œë¦¬ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. ì‘ì—…í•  ë•ŒëŠ” ì´ë²¤íŠ¸ë§ˆë‹¤ ê¸°ëŠ¥ì„ í•˜ë‚˜ ì´ìƒ ì˜ ë„£ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>

<h3 id="í˜ì´ì§€-ì²˜ë¦¬">í˜ì´ì§€ ì²˜ë¦¬</h3>

<p>ì´ˆê¸°ì— í–ˆë˜ í˜ì´ì§€ ì²˜ë¦¬ ë³´ë‹¤ ìµœê·¼ êµ¬í˜„í•œ í˜ì´ì§€ ì²˜ë¦¬ê°€ ë” ì¢‹ì§€ ì•Šë‚˜ ì¡°ì‹¬ìŠ¤ë ˆ ìƒê°í•´ë´…ë‹ˆë‹¤. ì´ì „ì—ëŠ” í˜ì´ì§€ì™€ í…œí”Œë¦¿ ë“±ì´ í˜¼ì¬ë˜ì–´ ìˆì—ˆëŠ”ë° ì ì  í•˜ë‹¤ë³´ë‹ˆ ì •ë¦¬ê°€ ë˜ëŠ” ë“¯ í•©ë‹ˆë‹¤.</p>

<p>ì¤€ë¹„í•œ ë‚´ìš©ì€ 3ê°€ì§€ ì…ë‹ˆë‹¤.</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">router.js</code></li>
  <li><code class="language-plaintext highlighter-rouge">pages.js</code></li>
  <li><code class="language-plaintext highlighter-rouge">main.js</code></li>
</ol>

<h4 id="router">router</h4>

<p>ë¼ìš°í„° jsëŠ” ë”± í˜ì´ì§€ë¥¼ êµ¬ì„±í•˜ëŠ” ëª¨ì²´ê°€ ë˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1">// router.js</span>
<span class="kd">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">home</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">referrer</span><span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">referrer</span><span class="p">,</span>
        <span class="na">select</span><span class="p">:</span> <span class="p">(</span><span class="nx">page</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">pages</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">page</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>í˜ì´ì§€ê°€ ê°€ì§€ëŠ” ìµœìƒìœ„ ê°œë…ì˜ ë‚´ìš©ë§Œì„ ê°€ì§‘ë‹ˆë‹¤. í˜ì´ì§€ë³„ <code class="language-plaintext highlighter-rouge">title</code>ì„ ì €ê¸°ì— ì¤˜ë„ ë©ë‹ˆë‹¤. ì €ëŠ” ë‚´ìš©ì„ ë Œë”í•˜ëŠ” ì‹œì ì— ë°”ê¾¸ê¸°ìœ„í•´ ì œì™¸í–ˆìŠµë‹ˆë‹¤.</p>

<h4 id="pages">pages</h4>

<p>í˜ì´ì§€ëŠ” í˜ì´ì§€ë¥¼ ë Œë”í•  í…œí”Œë¦¿ë§Œì„ ê°€ì§‘ë‹ˆë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="c1">// pages.js</span>
<span class="kd">const</span> <span class="nx">pages</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span><span class="o">=&gt;</span><span class="nx">templates</span><span class="p">[</span><span class="nx">type</span><span class="p">],</span>
    <span class="na">item</span><span class="p">:</span> <span class="p">(</span><span class="nx">type</span><span class="p">)</span><span class="o">=&gt;</span><span class="nx">parts</span><span class="p">[</span><span class="nx">type</span><span class="p">],</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">templates</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">home</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">render</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="nx">setInterval</span><span class="p">(()</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#timer</span><span class="dl">'</span><span class="p">)){</span>
                    <span class="kd">let</span> <span class="nx">base</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
                    <span class="kd">let</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">base</span><span class="p">.</span><span class="nx">getHours</span><span class="p">();</span>
                    <span class="kd">let</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">base</span><span class="p">.</span><span class="nx">getMinutes</span><span class="p">();</span>
                    <span class="kd">let</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">base</span><span class="p">.</span><span class="nx">getSeconds</span><span class="p">();</span>
                    <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#timer</span><span class="dl">'</span><span class="p">).</span><span class="nx">textContent</span> <span class="o">=</span> <span class="s2">`í˜„ì¬ì‹œê°„ </span><span class="p">${</span><span class="nx">h</span><span class="p">}</span><span class="s2">:</span><span class="p">${</span><span class="nx">m</span><span class="p">}</span><span class="s2">:</span><span class="p">${</span><span class="nx">s</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
                    <span class="c1">// textContentë¡œ í•œ ì´ìœ ëŠ” íƒœê·¸ìì²´ê°€ ë¦¬ë Œë”ë˜ëŠ” ê²Œ ì•„ë‹Œ</span>
                    <span class="c1">// í…ìŠ¤íŠ¸ë§Œ ë¦¬ë Œë”ë˜ì„œ ê¹”ë”í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.</span>
                <span class="p">}</span>
            <span class="p">});</span>
            <span class="k">return</span> <span class="s2">`&lt;div&gt;home ì…ë‹ˆë‹¤. &lt;time id="timer"&gt;&lt;/time&gt;&lt;/div&gt;`</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">parts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">side-bar</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">render</span><span class="p">:</span> <span class="kd">function</span><span class="p">(){</span>
            <span class="k">return</span> <span class="s2">`&lt;nav class="side-bar"&gt;
                &lt;ul&gt;
                    &lt;li&gt;home&lt;/li&gt;
                    &lt;li&gt;blog&lt;/li&gt;
                    &lt;li&gt;about&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/nav&gt;`</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">templates</code>ì™€ <code class="language-plaintext highlighter-rouge">parts</code>ëŠ” ë‹¤ë¥¸ ì„±ê²©ì…ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">templates</code>ëŠ” í˜ì´ì§€ ì²˜ë¦¬í•  ë•Œë§ˆë‹¤ ë°”ë€ŒëŠ” ë‚´ìš©ë“¤ì´ê³ , <code class="language-plaintext highlighter-rouge">parts</code>ëŠ” ëª¨ë“  í˜ì´ì§€ì˜ ê³µí†µë˜ëŠ” ìš”ì†Œë§Œì„ í‘œí˜„í•´ë‘ì—ˆìŠµë‹ˆë‹¤.</p>

<p>ì´í›„ í˜ì´ì§€ ì²˜ë¦¬ì—ì„œ ì´ ìë£Œë“¤ì„ ì–´ë–»ê²Œ ë¿Œë ¤ì£¼ê³  ê´€ë¦¬í•˜ëŠ”ì§€ ê°„ëµí•˜ê²Œ ë´…ì‹œë‹¤.</p>

<h4 id="í˜ì´ì§€ì²˜ë¦¬">í˜ì´ì§€ì²˜ë¦¬</h4>

<p>ì´ì „ì— <a href="https://kkn1125.github.io/javascript-design-pattern01">ìë°”ìŠ¤í¬ë¦½íŠ¸ ë””ìì¸ íŒ¨í„´ - ëª¨ë“ˆ íŒ¨í„´</a>ì„ ì†Œê°œí•œ ì ì´ ìˆìŠµë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ í•´ë‹¹ ë§í¬ë¥¼ ì°¸ì¡°í•´ì£¼ì„¸ìš”!</p>

<p>ëª¨ë“ˆ íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ì„ í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ìœ„ ì½”ë“œì—ì„œ ë²—ì–´ë‚˜ì§€ ì•Šê²Œ ì„¤ëª…ë“œë¦´ ê²ƒì´ê¸° ë•Œë¬¸ì— ì½”ë“œë¥¼ ì­‰ ì§œì§€ëŠ” ì•Šê² ìŠµë‹ˆë‹¤.</p>

<blockquote>
  <p>ì´ë²¤íŠ¸ ì²˜ë¦¬</p>
</blockquote>

<p>ì´ë²¤íŠ¸ëŠ” ìœ„ì—ì„œ ë¶„ê¸°í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë‹¤ ì…ë‹ˆë‹¤.</p>

<p>ë¬¼ë¡  <code class="language-plaintext highlighter-rouge">pushState</code>ë¡œ ì£¼ì†Œë¥¼ ë³€ê²½í•´ì£¼ì–´ì•¼í•˜ê³ , ì¢€ ë” ì¶”ê°€ë¥¼ í•˜ìë©´ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
</pre></td><td class="rouge-code"><pre><span class="c1">// main.js</span>
<span class="c1">// controller ì˜ì—­</span>
<span class="kd">let</span> <span class="nx">models</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">this</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">){</span> <span class="c1">// ì œì¼ ë¨¼ì € ì‹¤í–‰</span>
    <span class="c1">// modelë°›ê³ </span>
    <span class="nx">models</span> <span class="o">=</span> <span class="nx">model</span><span class="p">;</span>

    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">setBeforePage</span><span class="p">);</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handlePaging</span><span class="p">);</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">appInitialRender</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">this</span><span class="p">.</span><span class="nx">appInitialRender</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">models</span><span class="p">.</span><span class="nx">renderPage</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">this</span><span class="p">.</span><span class="nx">setBeforePage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">){</span>
    <span class="c1">// ëª¨ë¸ì— í´ë¦­ ì‹œì ì˜ í•´ì‰¬ë¥¼ ë³´ëƒ„</span>
    <span class="c1">// ì œì–´ë¬¸ ì‘ì„±í›„</span>
    <span class="nx">models</span><span class="p">.</span><span class="nx">setBeforePage</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">this</span><span class="p">.</span><span class="nx">handlePaging</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">){</span>
    <span class="c1">// ì œì–´ë¬¸ ì‘ì„±í›„</span>
    <span class="c1">// í˜ì´ì§€ ì²˜ë¦¬</span>
    <span class="c1">// ì˜ˆë¥¼ ë“¤ì–´</span>
    <span class="nx">models</span><span class="p">.</span><span class="nx">handlePaging</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">hash</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// model ì˜ì—­</span>
<span class="kd">let</span> <span class="nx">views</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">pageList</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">currentPage</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">beforePage</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">this</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">view</span><span class="p">){</span>
    <span class="nx">views</span> <span class="o">=</span> <span class="nx">view</span><span class="p">;</span>
    <span class="nx">pageList</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">router</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">this</span><span class="p">.</span><span class="nx">handlePaging</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">hash</span><span class="p">){</span>
    <span class="nx">currentPage</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">;</span>
    
    <span class="k">if</span><span class="p">(</span><span class="nx">beforePage</span> <span class="o">!==</span> <span class="nx">currentPage</span><span class="p">){</span>
        <span class="c1">// í˜ì´ì§• ì²˜ë¦¬í•˜ê¸° viewë¡œ ìœ„ì„</span>
    <span class="p">}</span>
    <span class="c1">// ì´ì™¸ ìš”ì²­ì€ í˜„ì¬ í˜ì´ì§€ë¥¼ ë˜ ìš”ì²­í•˜ë¯€ë¡œ ì•„ë¬´ ë™ì‘ í•˜ì§€ ì•Šë„ë¡ í•¨</span>
<span class="p">}</span>

<span class="k">this</span><span class="p">.</span><span class="nx">setBeforePage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">hash</span><span class="p">){</span>
    <span class="nx">beforePage</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">this</span><span class="p">.</span><span class="nx">renderPage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">// í˜„ì¬ í˜ì´ì§€ ë„˜ê¸°ë©´ì„œ ìœ„ì„</span>
    <span class="nx">views</span><span class="p">.</span><span class="nx">renderPage</span><span class="p">(</span><span class="nx">currentPage</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// view ì˜ì—­</span>
<span class="kd">let</span> <span class="nx">moduler</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">app</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="k">this</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">components</span><span class="p">){</span>
    <span class="nx">moduler</span> <span class="o">=</span> <span class="nx">components</span><span class="p">;</span>

    <span class="nx">app</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">insertAdjacentElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">beforeend</span><span class="dl">'</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">));</span>
    <span class="c1">// ìƒì„±í•˜ë©´ì„œ ë³€ìˆ˜ì— ì €ì¥ (insertAdjacentElementëŠ” ì—˜ë ˆë©˜íŠ¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.)</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">renderPublicOptions</span><span class="p">();</span> <span class="c1">// í˜ì´ì§€ ê³µí†µ ìš”ì†Œë“¤ ë Œë”</span>
<span class="p">}</span>

<span class="k">this</span><span class="p">.</span><span class="nx">renderPage</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="c1">// í˜ì´ì§€ ë Œë”</span>
<span class="p">}</span>

<span class="k">this</span><span class="p">.</span><span class="nx">renderPublicOptions</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">parts</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">part</span><span class="o">=&gt;</span><span class="nx">app</span><span class="p">.</span><span class="nx">insertAdjacentHTML</span><span class="p">(</span><span class="dl">'</span><span class="s1">beforeend</span><span class="dl">'</span><span class="p">,</span> <span class="nx">moduler</span><span class="p">.</span><span class="nx">parts</span><span class="p">[</span><span class="nx">part</span><span class="p">].</span><span class="nx">render</span><span class="p">()));</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>í˜„ì¬ ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— ì˜¬ë¼ê°€ ìˆëŠ” ì´ˆì•ˆì˜ ì¼ë¶€ë¥¼ ì‘ì„±í•´ë´¤ìŠµë‹ˆë‹¤. ë” ìì„¸íˆ ë³´ì‹œë ¤ë©´ <a href="https://github.com/kkn1125/router">router</a>ë¥¼ ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>

:ET