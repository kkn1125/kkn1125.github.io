I"‹&<h1 id="springì—ì„œ-mybatisë¥¼-ë¹ ë¥´ê²Œ-ì‚¬ìš©í•´ë³´ì">Springì—ì„œ MyBatisë¥¼ ë¹ ë¥´ê²Œ ì‚¬ìš©í•´ë³´ì</h1>

<p>ê¸°ë¡ìš©ì´ë¼ ë‹¤ì†Œ ë‚´ìš©ì´ ë¶€ì‹¤í•œ ì  ì–‘í•´ë°”ë¼ë©° ì°¸ê³ í•œ ì‚¬ì´íŠ¸ì˜ ë§í¬ë¥¼ ë‚¨ê²¨ë‘ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="mybatis-ì ìš©-ë¬¸ì œ">MyBatis ì ìš© ë¬¸ì œ</h2>

<blockquote>
  <p>ì‚¬ìš©ëœ ì˜ì¡´ì„±</p>
</blockquote>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="c">&lt;!-- ${org.springframework-version} === 5.3.6 --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-jdbc<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>${org.springframework-version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>mybatis-spring<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.0.6<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>mybatis<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>3.5.7<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>8.0.24<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="c">&lt;!-- ì°¸ê³ ë¡œ ë¡¬ë³µ ì‚¬ìš© ì¤‘ ì…ë‹ˆë‹¤. --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.18.22<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ì˜ì¡´ì„± ì¶”ê°€í•  ë•Œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ëŠ” <code class="language-plaintext highlighter-rouge">mybatis-spring</code>ê³¼ <code class="language-plaintext highlighter-rouge">mybatis</code>ì˜ ë²„ì „ì— ë”°ë¼ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë‹ˆ <code class="language-plaintext highlighter-rouge">maven repository</code>ì—ì„œ í™•ì¸í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">Spring-Boot</code>ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">application.properties</code>ë¡œ 
<code class="language-plaintext highlighter-rouge">mybatis.type-aliases-package='package.path'</code>ë§Œ ì„¤ì •í•´ì£¼ë©´ <code class="language-plaintext highlighter-rouge">@Mapper</code> ì–´ë…¸í…Œì´ì…˜ì„ ê³§ë°”ë¡œ ì‚¬ìš©í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í–ˆì—ˆìŠµë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">spring</code>ë„ ë˜ê² ê±°ë‹ˆí•˜ê³  ë‹¬ë‘ <code class="language-plaintext highlighter-rouge">Mapper</code> ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì˜€ë”ë‹ˆ ì—„ì²­ë‚˜ê²Œ ê¸´ ë¹¨ê°„ê¸€ë“¤ì„ ë±‰ì–´ëƒˆìŠµë‹ˆë‹¤â€¦</p>

<p>ì˜¤ë¥˜ë“¤ì„ ì­‰ ì½ë‹¤ë³´ë‹ˆ ë°œê²¬í•œ ë¬¸ì œì  4ê°€ì§€!</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">Autowired</code>ê°€ ì•ˆë˜ìš© (í•µì‹¬ì€ ì´ê²Œ ì•„ë‹ˆì—ˆìŠµë‹ˆë‹¤)</li>
  <li>sqlSessionFactory ì–´ì©Œê³ ê°€ ì—†ì–´ìš©</li>
  <li>mapperë¼ëŠ” Beanì„ ìƒì„±í•˜ì§€ ëª»í–ˆì–´ìš”!(ë¼ê³  ì˜ì–´ë¡œ ì í˜€ìˆì–´ìš”)</li>
  <li>mysql.cj ì–´ì©Œê³ ê°€ ë©”ëª¨ë¦¬ëˆ„ìˆ˜ ì–´ì©Œê³ â€¦</li>
</ol>

<p>ë³´í†µ ë³´ë©´ ì—ëŸ¬ ì¤‘ì—ì„œ ì œì¼ ìœ— ë…€ì„ì´ ì›ì´ˆì ì¸ ë¬¸ì œì¸ ê²½ìš°ê°€ ë§ë”ë¼êµ¬ìš”.</p>

<p><img src="/assets/images/post/springboot/mybatis/batis04.png" alt="ì—ëŸ¬ ì´ë¯¸ì§€" /></p>

<h2 id="mapperscanê³¼-sqlsessionfactory">MapperScanê³¼ SqlSessionFactory</h2>

<blockquote>
  <p>mapperë¥¼ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ëª¨ë¥´ì‹ ë‹¤ë©´ ë¸”ë¡œê·¸ì— ìˆëŠ” <a href="https://kkn1125/github.io/spring-boot-mybatis01">SPRING BOOT MyBatis ì‹œì‘í•˜ê¸°</a>ë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”!</p>
</blockquote>

<p>ë‘ ê°€ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">MapperScan</code>ê³¼ <code class="language-plaintext highlighter-rouge">SqlSessionFactory</code>ì¸ë°ìš”.</p>

<p><code class="language-plaintext highlighter-rouge">MapperScan</code>ì€ <code class="language-plaintext highlighter-rouge">basePackage</code> ê¸°ì¤€ìœ¼ë¡œ ì¡´ì¬í•˜ëŠ” <code class="language-plaintext highlighter-rouge">@Mapper</code> ì–´ë…¸í…Œì´ì…˜ì„ ëª…ì‹œí•œ <code class="language-plaintext highlighter-rouge">interface</code>ë¥¼ ìŠ¤ìº”í•©ë‹ˆë‹¤.</p>

<p>ì´ë•Œ í•´ë‹¹ë˜ëŠ” <code class="language-plaintext highlighter-rouge">interface</code>ë¥¼ ìŠ¤í”„ë§ <code class="language-plaintext highlighter-rouge">Bean</code>ìœ¼ë¡œ ì£¼ì…ë°›ì•„ <code class="language-plaintext highlighter-rouge">DB</code>ì— ì ‘ê·¼í•˜ê²Œ ë©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">@Mapper</code>ë§Œ ë‹¬ì•„ë‘ì—ˆë‹¤ê³  ë˜ëŠ” ê±´ ì•„ë‹Œ ë“¯ í•©ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">MapperScan</code>ìœ¼ë¡œ ì–´ë”” ìˆëŠ”ì§€ ì•Œë ¤ì£¼ê³ , sqlSessionFactoryë¥¼ ì„¸íŒ…í•´ì„œ dataSourceë¥¼ ë„˜ê¹ë‹ˆë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="c1">// RootConfig.java</span>
<span class="nd">@Configuration</span>
<span class="nd">@MapperScan</span><span class="o">(</span><span class="n">basePackages</span> <span class="o">=</span> <span class="o">{</span><span class="s">"com.springStudy.web"</span><span class="o">},</span>
<span class="n">annotationClass</span> <span class="o">=</span> <span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">ibatis</span><span class="o">.</span><span class="na">annotations</span><span class="o">.</span><span class="na">Mapper</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RootConfig</span> <span class="o">{</span>
    <span class="nd">@Bean</span>
	<span class="kd">public</span> <span class="nc">DataSource</span> <span class="nf">dataSource</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">DriverManagerDataSource</span> <span class="n">mysql</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DriverManagerDataSource</span><span class="o">();</span>
		<span class="n">mysql</span><span class="o">.</span><span class="na">setDriverClassName</span><span class="o">(</span><span class="s">"com.mysql.cj.jdbc.Driver"</span><span class="o">);</span>
		<span class="n">mysql</span><span class="o">.</span><span class="na">setUrl</span><span class="o">(</span><span class="s">"jdbc:mysql://localhost:3306/yourDbName"</span><span class="o">);</span>
		<span class="n">mysql</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="s">"name"</span><span class="o">);</span>
		<span class="n">mysql</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="s">"pass"</span><span class="o">);</span>
		<span class="k">return</span> <span class="n">mysql</span><span class="o">;</span>
	<span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">SqlSessionFactory</span> <span class="nf">sqlSessionFactory</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
            <span class="nc">SqlSessionFactoryBean</span> <span class="n">sessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBean</span><span class="o">();</span>
            <span class="n">sessionFactory</span><span class="o">.</span><span class="na">setDataSource</span><span class="o">(</span><span class="n">dataSource</span><span class="o">());</span>
            <span class="k">return</span> <span class="n">sessionFactory</span><span class="o">.</span><span class="na">getObject</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">@MapperScan</code> ì–´ë…¸í…Œì´ì…˜ì˜ ì£¼ì„ì— ìˆëŠ” ì˜ˆì œë¥¼ ë“¤ê³  ì™”ìŠµë‹ˆë‹¤. ì˜ ì‹¤í–‰ë©ë‹ˆë‹¤.</p>

<p>ì´ë ‡ê²Œ <code class="language-plaintext highlighter-rouge">SqlSessionFactory</code>ì™€ <code class="language-plaintext highlighter-rouge">MapperScan</code>ì„ ì„¤ì •í•˜ë‹ˆ ì˜¤ë¥˜ë„ í•´ê²°ë˜ê³  <code class="language-plaintext highlighter-rouge">Autowired</code>í–ˆë˜ <code class="language-plaintext highlighter-rouge">Service</code>ê°ì²´ë„ ì˜ ë°›ì•„ì™€ì„œ <code class="language-plaintext highlighter-rouge">DB</code>ë‚´ìš©ì„ ì˜ ì¶œë ¥í•©ë‹ˆë‹¤.</p>

:ET